let __array = {
  .push(self, v) => self[self.length++] = v,
  .pop(self) => self[--self.length],

  .iterator(self) {
    let i = 0
    return def => i < self.length then
      { .value = self[i++] } else
      { .done = true }
  },
  .drain(self) => def => self.length > 0 then
    { .value = self->pop() } else 
    { .done = true },

  .forEach(self, f) {
    let p
    for (let i = 0; i < self.length; i++) {
      let e = self[i]
      f(e, i, p)
      p = e
    }
    return self
  },
  .filter(self, f) {
    let a = [], p
    for (let i = 0; i < self.length; i++) {
      let e = self[i]
      if (f(e, i, p))
        a->push(e)
      p = e
    }
    return a
  },
  .map(self, f) {
    let p
    for (let i = 0; i < self.length; i++) {
      let e = self[i]
      self[i] = f(e, i, p)
      p = e
    }
    return self
  },
}
